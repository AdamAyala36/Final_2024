---
title: "Covid91 vaccine study Final2024"
author: "Adam Ayala"
output: 
  html_document:
    number_sections: true
    toc: true
    toc_depth: 5
date: "`r Sys.Date()`" 
---

```{r include=FALSE,echo=FALSE}
require(tidyverse)
require(tigerstats)
require(forcats)
FinalDat <-read.csv(file="finalSumr2024.csv",header=TRUE)
#recode to remove the annoying "X" from the dataframe
FinalData <- FinalDat  %>% select(-one_of("X"))
FinalData <- FinalData %>%
mutate(across(where(is.character), as.factor))
FinalData$treatment <- relevel(FinalData$treatment,ref="placebo")
#FinalData$infected <- relevel(FinalData$infected,ref="OK")
guy = filter(FinalData, sex =="M")
gal = filter(FinalData, sex =="F")
gay = filter(FinalData, LGBTQ =="gay")
Druguser = filter(FinalData, DrugUser =="yes")
```

# Introduction

A new  preventative vaccine (covid921) is under test in clinical trials. Given the nature of this vaccine it is suspected that the drug may exhibit different effectiveness across the variety of subpopulations tracked. Consider population subgroups by gender( guys and gals), drug use, and sexual orientation. Write a complete report that separately considers this drug for each subgroup and your recommendations as to whether people in the subgroup should take the vaccine. Structure your report in four sections each devoted to one of the four subgroups, use null and alternative hypothesis statements and correct statistical verbage when referencing p-values in conclusions.

## Males

```{r}
Males <- guy %>%
  group_by(infected,treatment) %>%
  summarize(count=n()) %>% 
  mutate(prcnt=count/sum(count))

basicC <- ggplot(Males,aes(x=infected,y=count,fill=treatment))
basicC + geom_bar(stat="identity",position="dodge")

basicCC <- ggplot(Males,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```


This plot represents the population of guys(males) people and the relationship of covid-19 by either taking the vaccine or the placebo. 


The plot shows covid19 being very low with those that took the vaccine in comparison to those with the placebo. The Placebo compared to the vaccine is about 3:1 in size.


### Numerical results

```{r}
table1 <- xtabs(~infected + treatment, data=guy)
rowPerc(table1)
colPerc(table1)
```

The males had a low percentage of 26.2% of males who got covid19 after taking the vaccine. Compared to those without a vaccine with 73.8% getting covid19. The vaccine is looking very promising.


### Inferential 



```{r}
chisq.test(table1)
chisqtestGC(table1)
guysfish <- fisher.test(table1)
guysfish
```


The information to play close attention to among all of these results is the output of the Fisher's Exact test. The p-value displayed above is extremely small at 2.2e-16  0.00000000000000022. Seeing this number means that these results are not likely to occur by chance.

Our odds ratio of about 2.8 proves that this vaccine is effective in stopping covid19 compared to a placebo.
```{r}
effect <- guysfish$p.value/(guysfish$p.value +1)
effectivenessguy = guysfish$estimate/(guysfish$estimate +1)*100
print(effectivenessguy)
```

```{r}
low=(guysfish$conf.int[1]/(guysfish$conf.int[1] +1))*100
hi=(guysfish$conf.int[2]/(guysfish$conf.int[2] +1))*100
options(digits=2)
```

## Effectiveness Confidence Interval `r low`  to `r hi`


The odds ratio of the males with vaccines vs those with placebos has a ratio greater than 70 meaning we have a effective vaccine for males. 


## Females
### Barplot

```{r}
Females <- gal %>% group_by(infected,treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))

basicC <- ggplot(Females,aes(x=infected,y=count,fill=treatment))
basicC + geom_bar(stat="identity",position="dodge")

basicCC <- ggplot(Females,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```
This plot represents the population of gals(females) people and the relationship to the contraction of covid-19 by either talking the vaccine or the placebo. 

Covid19 vaccine is shown to have a 2:1 ratio with the amount infected when compared to the placebo. The percentage seems to be about 36% for females who got infected with a vaccine compared to the percentage of about 65% of females who got infected with the placebo.

### Numerical results

```{r}
table1 <- xtabs(~infected + treatment, data=gal)
rowPerc(table1)
colPerc(table1)
```

Females that took the vaccine had 35% get infected with covid19 while those who took the placebo had a 65% who got infected. This does show to be about a 2:1 ratio

### Inferential 

```{r}
chisq.test(table1)
chisqtestGC(table1)
galsfish <- fisher.test(table1)
galsfish
```



The information to play close attention to among all of these results is the output of the Fisher's Exact test. The p-value displayed above is extremely small at 0.00000001. This is an extremely tiny number. seeing this number means that these results are not likely to occur by chance and so the null hypothesis can be rejected in favor of the alternative.


The Fishers's Exact Test illustrates that the odds ratio is 1.9. a good ratio for effectiveness. 

## LGBTQ



## Druggies


# Overall Results and Conclusions